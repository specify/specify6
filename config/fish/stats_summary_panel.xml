<?xml version="1.0" encoding="UTF-8"?>
<panel>

  <row>
      <box title="Specimen">
        <item title="Number of Specimens">
            <sql>
                <statement row="1" col="1">
                  <![CDATA[select count(*) from collectionobject]]>
                </statement>
            </sql>
        </item>
        <item title="Type Specimens">
            <sql>
                <statement row="1" col="1">
                  <![CDATA[select count(determinationid) from determination where TypeStatusName is not null]]>
                </statement>
            </sql>
        </item>
        <item title="Unique Families" useprogress="true">
            <sql type="custom" name="UniqueFamilies">
                <statement>
                    <![CDATA[create temporary table Families1 select TaxonID FROM determinationstatus Inner Join determination ON determination.DeterminationStatusID = determinationstatus.DeterminationStatusID where determinationstatus.IsCurrent = true]]>
                </statement>
                <statement>
                  <![CDATA[create temporary table Families2 select DISTINCT tax.TaxonID,tax.nodenumber from Families1,taxon as tax where tax.isaccepted <> 0 and tax.TaxonID = Families1.TaxonID]]>
                </statement>
               <statement>
                  <![CDATA[create temporary table Families3 select DISTINCT tx.TaxonID from Families2, taxon as tx where tx.rankid = 140 and Families2.nodenumber between tx.nodenumber and tx.HighestChildNodeNumber]]>
                </statement>
                <statement row="1" col="1">
                  <![CDATA[select count(*) from Families3]]>
                </statement>
                <statement>
                  <![CDATA[drop table Families1]]>
                </statement>
                <statement>
                  <![CDATA[drop table Families2]]>
                </statement>
                <statement>
                  <![CDATA[drop table Families3]]>
                </statement>
            </sql>
        </item>
        <item title="Unique Genera" useprogress="true">
            <sql>
                <statement>
                    <![CDATA[create temporary table Genera1 select TaxonID FROM determinationstatus Inner Join determination ON determination.DeterminationStatusID = determinationstatus.DeterminationStatusID where determinationstatus.IsCurrent = true]]>
                </statement>
                <statement>
                  <![CDATA[create temporary table Genera2 select DISTINCT tax.TaxonID,tax.nodenumber from Genera1,taxon as tax where tax.isaccepted <> 0 and tax.TaxonID = Genera1.TaxonID]]>
                </statement>
               <statement>
                  <![CDATA[create temporary table Genera3 select DISTINCT tx.TaxonID from Genera2, taxon as tx where tx.rankid = 180 and Genera2.nodenumber between tx.nodenumber and tx.HighestChildNodeNumber]]>
                </statement>
                <statement row="1" col="1">
                  <![CDATA[select count(*) from Genera3]]>
                </statement>
                <statement>
                  <![CDATA[drop table Genera1]]>
                </statement>
                <statement>
                  <![CDATA[drop table Genera2]]>
                </statement>
                <statement>
                  <![CDATA[drop table Genera3]]>
                </statement>
            </sql>
        </item>
        <item title="Unique Species" useprogress="true">
            <sql>
                <statement>
                    <![CDATA[create temporary table Species1 select TaxonID FROM determinationstatus Inner Join determination ON determination.DeterminationStatusID = determinationstatus.DeterminationStatusID where determinationstatus.IsCurrent = true]]>
                </statement>
                <statement>
                  <![CDATA[create temporary table Species2 select DISTINCT tax.TaxonID,tax.nodenumber from Species1,taxon as tax where tax.isaccepted <> 0 and tax.TaxonID = Species1.TaxonID]]>
                </statement>
               <statement>
                  <![CDATA[create temporary table Species3 select DISTINCT tx.TaxonID from Species2, taxon as tx where tx.rankid = 220 and Species2.nodenumber between tx.nodenumber and tx.HighestChildNodeNumber]]>
                </statement>
                <statement row="1" col="1">
                  <![CDATA[select count(*) from Species3]]>
                </statement>
                <statement>
                  <![CDATA[drop table Species1]]>
                </statement>
                <statement>
                  <![CDATA[drop table Species2]]>
                </statement>
                <statement>
                  <![CDATA[drop table Species3]]>
                </statement>
            </sql>
        </item>
        <item title="Taxa in Collection" useprogress="true">
            <sql><statement><![CDATA[select count(TaxonID) AS TaxaInCollectionCount from taxon where TaxonID in (select TaxonId from determination where DeterminationStatusID = 1)]]></statement></sql>
        </item>
      </box>
      <box title="Data Entry">
        <item title="Cataloged in Last 7 Days">
            <sql><statement><![CDATA[select count(*) from collectionobject where DATE_SUB(CURDATE(), INTERVAL 7 DAY) <= TimestampCreated]]></statement></sql>
            <link>CatalogedLast7DaysDetail</link>
        </item>
        <item title="Cataloged in Last 30 Days">
            <sql><statement><![CDATA[select count(*) from collectionobject where DATE_SUB(CURDATE(), INTERVAL 1 MONTH) <= TimestampCreated]]></statement></sql>
            <link>CatalogedLastMonth</link>
        </item>
        <item title="Cataloged in Last Year">
            <sql><statement><![CDATA[select count(*) from collectionobject WHERE DATE_SUB(CURDATE(), INTERVAL 1 YEAR) <= TimestampCreated;]]></statement></sql>
            <link>CatalogedLastYear</link>
        </item>
      </box>
  </row>
  <row>
      <box title="Loans">
        <item title="Items On Loan">
            <sql><statement><![CDATA[select count(loanphysicalobjectid) AS ItemsOnLoanCount from loanphysicalobject as lpo inner join loan on loan.loanid = lpo.loanid where loan.IsGift = false and quantityresolved < quantity and (IsClosed = false or IsClosed is null)]]></statement></sql>
        </item>
        <item title="Overdue Loans">
            <sql><statement><![CDATA[select count(loanid) as OpenLoanCount from loan where loanid in (select loanid from loan where (not (currentduedate is null)) and loan.IsGift = false and (IsClosed = false or IsClosed is null) and datediff(CURDATE(), currentduedate) > 0)]]></statement></sql>
            <link>OverdueLoansList</link>
        </item>
        <item title="Open Loans">
            <sql><statement><![CDATA[select count(loanid) as OpenLoanCount from loan where loan.IsGift = false and (IsClosed = false or IsClosed is null)]]></statement></sql>
            <link>ListOnLoan</link>
        </item>
      </box>
      <box title="Locality/Geography">
        <item title="Number of Localities">
            <sql><statement><![CDATA[select count(*) from locality]]></statement></sql>
        </item>
        <item title="Number of Geographies">
            <sql><statement><![CDATA[select count(*) from geography]]></statement></sql>
        </item>
        <item title="Number of Countries" useprogress="true">
            <sql><statement><![CDATA[select count(Name) from (select DISTINCT Name from (select g.GeographyID,g.nodenumber from locality as l inner join geography as g on l.GeographyID = g.GeographyID) as GEO, geography as g where g.rankid = 200 and GEO.nodenumber between g.nodenumber and g.HighestChildNodeNumber) As GEO2]]></statement></sql>
        </item>
        <item title="Percent Geo Referenced">
            <sql><statement><![CDATA[select CASE WHEN (select count(*) from locality) = 0 THEN 0 ELSE ((count(localityid) * 1.0) / ((select count(*) from locality) * 1.0)) * 100.0 END AS PercentGeoReferencedLocalities from locality where not latitude1 is null]]></statement></sql>
        </item>
    </box>
  </row>
  <row>
    <box title="Taxonomic Tree Information">
        <item title="Class">
            <sql><statement><![CDATA[select count(*) from taxon where taxon.rankid = 60]]></statement></sql>
        </item>
        <item title="Order">
            <sql><statement><![CDATA[select count(*) from taxon where taxon.rankid = 100]]></statement></sql>
        </item>
        <item title="Families">
            <sql><statement><![CDATA[select count(*) from taxon where taxon.rankid = 140]]></statement></sql>
        </item>
        <item title="Genera">
            <sql><statement><![CDATA[select count(*) from taxon where taxon.rankid = 180]]></statement></sql>
        </item>
        <item title="Species">
            <sql><statement><![CDATA[select count(*) from taxon where taxon.rankid = 220]]></statement></sql>
        </item>
    </box>
      <box title="Taxa Type Counts" desccol="1" valcol="2" desctitle="Taxon" valtitle="Count" noresults="No Type Specimens">
		<sql><![CDATA[select TypeStatusName, count(determinationid) AS DeterminationCount from determination where TypeStatusName is not null group by TypeStatusName]]></sql>
    </box>
  </row>

</panel>

<!--
    This is the Total Number of Countries Used by all the Localities
    select count(Name) from (select DISTINCT Name from (select g.GeographyID,g.nodenumber from locality as l inner join geography as g on l.GeographyID = g.GeographyID) as GEO, geography as g where g.rankid = 200 and GEO.nodenumber between g.nodenumber and g.HighestChildNodeNumber) As GEO2
    
    
-->
