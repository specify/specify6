<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<head>
<link href="../../main.css" rel="stylesheet" type="text/css" media="screen"></link>
<title>Import from XLS</title>
</head>

<body>
<table width="100%" border="0" background="../../images/topbar.png">
  <tr>
    <td>&nbsp;</td>
  </tr>
</table>
<h2>Importing Data from an MS Excel file </h2>
<p>The WorkBench can easily import data from an MS Excel file into a new Data Set. </p>
<p>The WorkBench uses HSSF as the port for the Microsoft Excel 97(-2003) file format (BIFF8) to pure Java, which supports read and write capability. (Support for Excel 2007 .xlsx files is in progress). Please see the HSSF project page for more information. </p>
<p><em><strong>Notes:</strong></em> </p>
<ul>
  <li>Changes made to the data in the WorkBench will not be reflected in the original MS Excel file.</li>
  <li> The WorkBench has a 4000 row maximum. Files that include more than 4000 rows will not import. </li>
  <li>Excel files that contain more than 4000 rows can be split using the <a href="../Uploading/splitter.html">Specify File Splitter</a> tool.</li>
</ul>
<p align="center" class="imgcaption">&nbsp;</p>
<p>To begin, click on the Import Data action on the side bar and choose the import file in the file dialog. </p>
<p>To properly import the data from an MS Excel file, the WorkBench must first determine if the data includes column headings. The following information dialog appears after the file 
dialog:</p>
<p align="center"><img src="../images/importdialog.png" width="617" height="367"></p>
<p align="center" class="imgcaption">Import from MS Excel </p>
<p align="center" class="imgcaption">&nbsp;</p>
<p>The Data Preview window reads and displays a sample of the column headings and data from the import file. If the file does not contain column headings, the columns will be labelled in  
numerical order (Column 1, Column 2, etc.). Check the 'First row contains column headings' box according to how the file displays in the Data Preview window. </p>
<p>The next step in the import process is to 'map' the  column headings from the import file to  the  fields in the Specify data model. </p>
<p>&nbsp;</p>
<h3>File <em>includes</em>  Column Headings  </h3>
<p>The Workbench includes an '<span class="index">auto-mapping</span>' feature which  first identifies  column headings and compares them to existing Data Sets. If the column headings 
in the import file match those in an existing Data Set the following dialog will open:</p>
<p align="center"><img src="../images/NewDataSet.png" width="340" height="284"></p>
<p align="center" class="imgcaption">New Data Set Column Headings </p>
<p>To reuse the 'map' from an existing Data Set select the 'Use an existing Data Set mapping' button and choose the Data Set from the list provided. The Data Set 
Properties dialog will then open, to name and describe the new Data Set. </p>
<p>To create a new map for the  Data Set select the 'Create new Data Set mapping' button and click 'OK'.</p>
<p><strong><em>Note:</em></strong> Mappings can only be reused if the XLS file being imported contains the same or fewer columns than the mapping. In other words, if you split an XLS file into two smaller files for import, then import the first XLS file but do not map all the columns, the unmapped columns are discarded. When you then import the second XLS file you will <em>NOT</em> be given the option to reuse the mapping created for the first XLS file. To reuse the mapping you must first delete the unmapped/discarded columns from  the  XLS file before importing it into the WorkBench. </p>
<p>&nbsp;</p>
<p>The 'auto-mapper' then compares the imported column headings to the Specify fields and 'maps' the columns to matching fields. </p>
<p align="center"><img src="../images/automappededitor.png" width="720" height="384"></p>
<p align="center" class="imgcaption">Column Headings Automapped in the Data Set Mapping Editor </p>
<p>&nbsp;</p>
<p>The column headings from the import file appear under 'Data Set Columns' on the right side of the dialog and are mapped to  'Specify Fields'  on the left. </p>
<p><span class="index">Column headings</span> that map to Specify fields display a <img src="../images/linked.png" width="32" height="16"> (linked) icon. </p>
<p>Column headings that have not been automapped will have  'To Be Discarded' displayed under 'Specify Fields'. Unmapped column headings will be deleted if they are not 
mapped to a Specify field before clicking 'OK'.</p>
<p>The buttons in the dialog enable columns to be mapped, unmapped, added, deleted and reordered.</p><br>
<table width=500 border="1" cellspacing="1" cellpadding="6">
  <tr>
    <td><u><strong>Icon</strong></u></td>
    <td><u><strong>Name</strong></u></td>
    <td><u><strong>Result</strong></u></td>
  </tr>
  <tr>
    <td width=50><img src="../images/Map16x16.png" alt="map" width="16" height="16"></td>
    <td width=100><span class="index">Map</span></td>
    <td> Adds the field to the column list.</td>
  </tr>
  <tr>
    <td><img src="../images/Unmap16x16.png" alt="unmap" width="16" height="16"></td>
    <td><span class="index">Unmap</span></td>
    <td>Removes the field from the list of columns.</td>
  </tr>
  <tr>
    <td><img src="../images/ReorderUp16x16.png" alt="reorderup" width="16" height="16"></td>
    <td><span class="index">Reorder up</span></td>
    <td>Moves the selected field up.</td>
  </tr>
  <tr>
    <td><img src="../images/ReorderDown16x16.png" alt="reorderdown" width="16" height="16"></td>
    <td><span class="index">Reorder down</span></td>
    <td>Moves the selected field down.</td>
  </tr>
</table>
<p>&nbsp;</p>
<p>To map an unmapped Data Set column to a Specify field:</p>
<ol>
  <li>Click on the column in the right hand window to select it.</li>
  <li>Click on the Data Type to display the associated fields in the 'Specify Fields' window.</li>
  <li>Click on the required Specify field to select it.</li>
  <li>Click the <img src="../images/Map16x16.png" alt="map" width="16" height="16"> (map) button.</li>
</ol>
<p>To  unmap a column from a field:</p>
<ol>
  <li>Click on the column in the right hand window to select it.</li>
  <li>Click the <img src="../images/Unmap16x16.png" alt="unmap" width="16" height="16"> (unmap) button.</li>
</ol>
<p>To add a column </p>
<ol>
  <li>Click on the Data Type to show the Specify fields in the 'Fields' window.</li>
  <li>Click on the Specify field.</li>
  <li>Click the <img src="../images/Map16x16.png" alt="map" width="16" height="16"> (map) button.</li>
</ol>
<p>A <img src="../images/linked_right.png" alt="link" width="32" height="16"> (link) icon confirms that the column and field are the same heading. </p>
<blockquote>
  <p><em><strong>Note:</strong></em> A field may only map once. Specify fields that are mapped display a green check mark next to their name in the Specify field list confirming that they are in use. </p>
  <p><em><strong>Note:</strong></em> When importing Taxon information only use the Taxon Only Table in the mapping editor. </p>
  <p><em><strong>Note:</strong></em> The Agent table in the mapping editor may only be used for agent information. When uploading agent information along with collection object information use the Cataloger Title, First Name, Middle Name and Last Name fields in the Collection Object table.</p>
</blockquote>
<p>&nbsp;</p>
<p>When all the Columns are mapped and ordered correctly click the 'OK' button. </p>
<p>Complete the import process by   naming  and describing the new Data Set:</p>
<p align="center"><img src="../images/datasetproperties.png" ></p>
<p align="center" class="imgcaption">Data Set Properties </p>
<p>&nbsp;</p>
<h3>File does <em>NOT</em> include Column Headings </h3>
<p>Import files that do not contain column headings can not be 'automapped' to fields in Specify. Columns are labelled according to their numerical order and need to be manually mapped. </p>
<p align="center"><img src="../images/nonamesmap.png" ></p>
<p align="center" class="imgcaption">Map of Import File with No Column Headings </p>
<p align="left">&nbsp;</p>
<p align="left">Columns that do not include headings  display 'To Be Discarded' rather than mapping to  Specify fields. Unmapped column headings will be deleted if they are not mapped to a Specify field before clicking 'OK'.</p>
<p align="left">The buttons in the dialog enable columns to be mapped, unmapped, added, deleted and reordered . The function of each button is described below:</p>
<table width=500 border="1" cellspacing="1" cellpadding="6">
  <tr>
    <td width=50><img src="../images/Map16x16.png" alt="map" width="16" height="16"></td>
    <td width=100><span class="index">Map</span></td>
    <td>Adds the field to the column list.</td>
  </tr>
  <tr>
    <td><img src="../images/Unmap16x16.png" alt="unmap" width="16" height="16"></td>
    <td><span class="index">Unmap</span></td>
    <td>Removes the field from the list of columns.</td>
  </tr>
  <tr>
    <td><img src="../images/ReorderUp16x16.png" alt="reorderup" width="16" height="16"></td>
    <td><span class="index">Reorder up</span></td>
    <td>Moves the selected field up.</td>
  </tr>
  <tr>
    <td><img src="../images/ReorderDown16x16.png" alt="reorderdown" width="16" height="16"></td>
    <td><span class="index">Reorder down</span></td>
    <td>Moves the selected field down.</td>
  </tr>
</table>
<p>&nbsp;</p>
<p>To map an unmapped Data Set column to a Specify field:</p>
<ol>
  <li>Click on the column in the right hand window to select it.</li>
  <li>Click on the Data Type to display the associated fields in the 'Specify Fields' window.</li>
  <li>Click on the required Specify field to select it.</li>
  <li>Click the <img src="../images/Map16x16.png" alt="map" width="16" height="16"> (map) button.</li>
</ol>
<p>To  unmap a column from a field:</p>
<ol>
  <li>Click on the column in the right hand window to select it.</li>
  <li>Click the <img src="../images/Unmap16x16.png" alt="unmap" width="16" height="16"> (unmap) button.</li>
</ol>
<p>To add a column </p>
<ol>
  <li>Click on the Data Type to show the Specify fields in the 'Fields' window.</li>
  <li>Click on the Specify field.</li>
  <li>Click the <img src="../images/Map16x16.png" alt="map" width="16" height="16"> (map) button.</li>
</ol>
<p>A <img src="../images/linked_right.png" alt="link" width="32" height="16"> (link) icon will appear identifying that the column and field are the same heading. </p>
<blockquote>
  <p><em><strong>Note:</strong></em> A field may only map once. Specify fields that are mapped display a green check mark next to their name in the Specify field list confirming that they are in use. </p>
  <p><em><strong>Note:</strong></em> When importing Taxon information only use the Taxon Only Table in the mapping editor. </p>
  <p><em><strong>Note:</strong></em> The Agent table in the mapping editor may only be used for agent information. When uploading agent information along with collection object information use the Cataloger Title, First Name, Middle Name and Last Name fields in the Collection Object table.</p>
</blockquote>
<p>&nbsp;</p>
<p>When all the columns are mapped and ordered correctly click the 'OK' button. </p>
<p>Complete the import process by   naming  and describing the new Data Set:</p>
<p align="center"><img src="../images/datasetproperties.png" alt="data set properties"></p>
<p align="center" class="imgcaption">Data Set Properties </p>
<p align="left">&nbsp;</p>
<p>To rename columns headings see <a href="../Workbench/FormEditing.html">Form Editing</a>. </p>
<p>&nbsp;</p>
<blockquote>
  <p><em><strong>Note:</strong></em> When the data set opens the validation for invalid fields will be turned on.  The validation can be turned off by unchecking the <em>Highlight Invalid Cells</em> checkbox in the validation panel at the bottom of the work space.</p>
</blockquote>
<p align="center"><img src="../../images/validation_screen.png" alt="" width="562" height="31" /></p>
<p align="center" class="imgcaption">Validation Panel </p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>Bad Imports </h3>
<p>MS Excel  files that are corrupt or have not been saved correctly will not import correctly into the WorkBench. A bad file may appear in the Data Set Mapping Editor with partial or no column headings, or  display a warning at the bottom of the WorkBench window: </p>
<p>&nbsp;</p>
<p align="center"><img src="../images/wrongfilewarning.png" alt="Wrong File Warning" ></p>
<p align="center" class="imgcaption">File Warning </p>
<h2></h2>
</body>
</html>
